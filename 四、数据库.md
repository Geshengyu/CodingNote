## 四、数据库

### 4.1 架构

![](https://github.com/Geshengyu/CodingNote/blob/master/%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9E%B6%E6%9E%84.png?raw=true)

### 4.2 索引

#### 4.2.1 密集索引与稀疏索引的区别

MyISAM：B+Tree叶节点的data域存放的是数据记录的地址。因此索引文件与数据文件是分离的。**稀疏索引**

InnoDB：其表数据文件本身就是按B+Tree组织的一个索引结构，树的叶节点data域保存了完整的数据记录。根据主索引搜索时，直接找到key所在的节点即可取出数据；在根据辅助索引查找时，则需要先取出主键的值，再走一遍主索引。 **密集索引**

#### 4.2.2 如何定位并优化慢查询sql



#### 4.2.3 联合索引的最左匹配原则的成因



#### 4.2.4 索引是建立的越多越好吗？

数据量小的表不需要建立索引

数据变更需要维护索引

索引意味着需要更多的空间

### 4.3 锁

#### 4.3.1 MyISAM与InnoDB关于锁方面的区别？

MyISAM默认表级锁，不支持行级锁

InnoDB默认行级锁，也支持表级锁

#### 4.3.2 数据库事务的四大特性

1. **原子性（Atomicity）：** 事务是最小的执行单位，不允许分割。事务的原子性确保动作要么全部完成，要么完全不起作用；
2. **一致性（Consistency）：** 执行事务前后，数据保持一致，多个事务对同一个数据读取的结果是相同的；
3. **隔离性（Isolation）：** 并发访问数据库时，一个用户的事务不被其他事务所干扰，各并发事务之间数据库是独立的；
4. **持久性（Durability）：** 一个事务被提交之后。它对数据库中数据的改变是持久的，即使数据库发生故障也不应该对其有任何影响。

#### 4.3.3 事务隔离级别以及各级别下的并发访问问题



#### 4.3.4 InnoDB可重复读隔离级别下如何避免幻读



#### 4.3.4 RC、RR级别下的InnoDB的非阻塞读如何实现







### 4.4 MySQL实战

是一种关系型数据库，默认端口：3306

存储引擎：MyISAM和InnoDB

|        |            |                            |          |                          |
| ------ | ---------- | -------------------------- | -------- | ------------------------ |
| MyISAM |            |                            |          |                          |
| InnoDB | 支持行级锁 | 支持事务和崩溃后的安全修复 | 支持外键 | 支持MVCC，应对高并发事务 |
|        |            |                            |          |                          |

